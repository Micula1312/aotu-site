/* AOTU — Archive (cards + lightbox), theme-aware (Matrix dark + light)
   Drop this next to js/archive.js and include it in Base or this page.
*/

/* Toolbar (filters/search) */
section.bar {
  display: inline;
  grid-template-columns: 140px 1fr auto;
  gap: 10px;
  margin: 12px 0 14px;
}
@media (max-width: 720px) {
  section.bar { grid-template-columns: 1fr; }
}

section.bar select,
section.bar input,
section.bar button {
  padding: 10px 12px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: linear-gradient(180deg, var(--chip-bg, #012313), color-mix(in srgb, var(--chip-bg, #012313) 86%, #000 14%));
  color: var(--fg);
  box-shadow: var(--shadow-inset);
}
section.bar input::placeholder { color: color-mix(in srgb, var(--muted) 70%, transparent); }
section.bar button { cursor: pointer; font-weight: 700; }
section.bar button:hover { box-shadow: var(--shadow-neon); }


section.bar .archive-filters-wrapper {
display: flex;
}

section.bar .archive-filters-wrapper input {
flex: auto;
}

/* Loading / state */
#state.loading {
  color: var(--muted);
  letter-spacing: .05em;
  padding: 8px 0;
}

/* Responsive card grid */
#grid.grid {
  --min: 240px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(var(--min), 1fr));
  gap: 14px;
  padding: 4px 0 8px;
}

/* Card — immagine full + titolo overlay */
.card {
  position: relative;
  border: 1px solid var(--accent);          /* bordo verde */
  border-radius: var(--radius);
  overflow: hidden;
  background: #000;                          /* fallback */
  box-shadow: var(--shadow-inset), 0 10px 28px rgba(0,0,0,.25);
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}
.card:hover {
  transform: translateY(-3px);
  box-shadow: 0 0 20px color-mix(in srgb, var(--accent) 35%, transparent),
              0 14px 34px rgba(0,0,0,.35);
  border-color: var(--accent-2);
}

/* Immagine a tutta card + effetto pixel */
:root { --pixel-zoom: 10; }                 /* regola l'intensità del pixel */
.card img, .card .ph, .card .pv {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  aspect-ratio: 4/3;
  border: none;
  border-radius: 0;
  background: var(--surface);

  /* pixel look: forza upscaling + pixel rendering */
  image-rendering: pixelated;
  image-rendering: crisp-edges; /* fallback */
  /* transform: scale(var(--pixel-zoom)); */
  /* transform-origin: center;
  will-change: transform; */
}

/* La card ora è full-bleed: il link non ha padding */
.card a { display: block; padding: 0; }

/* Lightbox: nascondi eventuali note */
#lb #lbNotes { display: none !important; }

/* Titolo in overlay — sempre visibile */
.card .title {
  position: absolute;
  bottom: 0; left: 0; width: 100%;
  margin: 0;
  padding: 0.6rem 0.8rem;
  font-size: 15px;
  font-weight: 700;
  line-height: 1.25;
  color: var(--fg);
  text-align: center;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(2px);
}
.card .title::before { content: none; }

/* Nascondi metadati extra nelle card */
.card .meta, .card .muted { display: none !important; }

/* Rimuovi il layout grid interno al link, ora la card è full-bleed */
.card a { display: block; padding: 0; }


/* Lightbox */
dialog#lb {
  width: min(980px, 96vw);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: linear-gradient(180deg, var(--surface), var(--panel-grad-bot, #000));
  color: var(--fg);
  box-shadow: 0 30px 80px rgba(0,0,0,.5);
  padding: 0;
}
#lb::backdrop { background: rgba(0,0,0,.6); }

#lb .close {
  position: absolute;
  right: 10px; top: 10px;
  z-index: 2;
  border: 1px solid var(--border);
  background: var(--chip-bg, #012313);
  color: var(--fg);
  border-radius: var(--radius-s);
  padding: 6px 10px;
  cursor: pointer;
}
#lb .lb-wrap {
  display: grid;
  grid-template-columns: 1.2fr .8fr;
  gap: 14px;
  padding: 14px;
}
@media (max-width: 820px) {
  #lb .lb-wrap { grid-template-columns: 1fr; }
}

#lb .lb-media {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: #000;
  display: grid;
  place-items: center;
  overflow: hidden;
  min-height: 240px;
}
#lb .lb-media img, #lb .lb-media video, #lb .lb-media audio {
  max-width: 100%;
  height: auto;
  display: block;
}
#lb .lb-meta { padding: 6px; }
#lb .lb-title { margin: 0 0 6px; }
#lb .muted { color: var(--dim); }
#lb #lbTags { color: var(--muted); font-size: 13px; }
#lb #lbNotes { font-size: 14px; line-height: 1.55; }

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .card { transition: none; }
}




/* Audio preview: piccolo bottone overlay + hover play */
.card .audio-wrap { position: relative; }
.card .audio-wrap audio.pv { width: 100%; height: auto; display: block; aspect-ratio: 4/3; background:#000; }
.card .audio-play {
  position: absolute;
  left: 8px; bottom: 8px; z-index: 2;
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 6px 10px;
  cursor: pointer;
  background: rgba(0,0,0,.6);
  color: #fff; font-size: 12px; font-weight: 700;
  backdrop-filter: blur(2px);
}
.card .audio-play:hover { background: rgba(0,0,0,.75); }

/* Placeholder (DOC) già presente come .ph — ok */
