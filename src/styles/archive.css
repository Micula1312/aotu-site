/* AOTU — Archive (cards + lightbox), theme-aware (Matrix dark + light)
   Drop this next to js/archive.js and include it in Base or this page.
*/

/* Toolbar (filters/search) */
section.bar {
  display: grid;
  grid-template-columns: 140px 1fr auto;
  gap: 10px;
  margin: 12px 0 14px;
}
@media (max-width: 720px) {
  section.bar { grid-template-columns: 1fr; }
}

section.bar select,
section.bar input,
section.bar button {
  padding: 10px 12px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: linear-gradient(180deg, var(--chip-bg, #012313), color-mix(in srgb, var(--chip-bg, #012313) 86%, #000 14%));
  color: var(--fg);
  box-shadow: var(--shadow-inset);
}
section.bar input::placeholder { color: color-mix(in srgb, var(--muted) 70%, transparent); }
section.bar button { cursor: pointer; font-weight: 700; }
section.bar button:hover { box-shadow: var(--shadow-neon); }

/* Loading / state */
#state.loading {
  color: var(--muted);
  letter-spacing: .05em;
  padding: 8px 0;
}

/* Responsive card grid */
#grid.grid {
  --min: 240px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(var(--min), 1fr));
  gap: 14px;
  padding: 4px 0 8px;
}

/* Card */
.card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: linear-gradient(180deg, var(--surface), var(--panel-grad-bot, #000));
  box-shadow: var(--shadow-inset), 0 10px 28px rgba(0,0,0,.25);
  overflow: hidden;
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}
.card:hover {
  transform: translateY(-3px);
  box-shadow: 0 0 20px color-mix(in srgb, var(--accent) 35%, transparent), 0 14px 34px rgba(0,0,0,.35);
  border-color: var(--accent-2);
}
.card a { display: grid; grid-template-columns: 120px 1fr; gap: 12px; padding: 10px; color: inherit; text-decoration: none; }
@media (max-width: 560px) {
  .card a { grid-template-columns: 1fr; }
}

/* Thumbnail / placeholder */
.card img, .card .ph, .card .pv {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  aspect-ratio: 4/3;
  border: 1px solid color-mix(in srgb, var(--border) 60%, transparent);
  border-radius: calc(var(--radius) - 6px);
  background:
    linear-gradient(90deg, var(--gridline, rgba(0,255,120,.06)) 1px, transparent 1px) 0 0 / 20px 100%,
    linear-gradient(0deg, var(--gridline, rgba(0,255,120,.06)) 1px, transparent 1px) 0 0 / 100% 20px,
    linear-gradient(135deg, color-mix(in srgb, var(--accent) 12%, #04140c), #010905);
}
.card .ph {
  display: grid; place-items: center; font-weight: 800; letter-spacing: .08em;
  color: var(--muted);
}

/* Meta */
.card .meta { display: grid; align-content: center; gap: 4px; min-height: 100%; }
.card .title { margin: 0; font-size: 15px; line-height: 1.25; }
.card .title::before { content: "> "; color: var(--muted); }
.card .muted { color: var(--dim); font-size: 12px; }

/* Lightbox */
dialog#lb {
  width: min(980px, 96vw);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: linear-gradient(180deg, var(--surface), var(--panel-grad-bot, #000));
  color: var(--fg);
  box-shadow: 0 30px 80px rgba(0,0,0,.5);
  padding: 0;
}
#lb::backdrop { background: rgba(0,0,0,.6); }

#lb .close {
  position: absolute;
  right: 10px; top: 10px;
  z-index: 2;
  border: 1px solid var(--border);
  background: var(--chip-bg, #012313);
  color: var(--fg);
  border-radius: var(--radius-s);
  padding: 6px 10px;
  cursor: pointer;
}
#lb .lb-wrap {
  display: grid;
  grid-template-columns: 1.2fr .8fr;
  gap: 14px;
  padding: 14px;
}
@media (max-width: 820px) {
  #lb .lb-wrap { grid-template-columns: 1fr; }
}

#lb .lb-media {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: #000;
  display: grid;
  place-items: center;
  overflow: hidden;
  min-height: 240px;
}
#lb .lb-media img, #lb .lb-media video, #lb .lb-media audio {
  max-width: 100%;
  height: auto;
  display: block;
}
#lb .lb-meta { padding: 6px; }
#lb .lb-title { margin: 0 0 6px; }
#lb .muted { color: var(--dim); }
#lb #lbTags { color: var(--muted); font-size: 13px; }
#lb #lbNotes { font-size: 14px; line-height: 1.55; }

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .card { transition: none; }
}




/* Audio preview: piccolo bottone overlay + hover play */
.card .audio-wrap { position: relative; }
.card .audio-wrap audio.pv { width: 100%; height: auto; display: block; aspect-ratio: 4/3; background:#000; }
.card .audio-play {
  position: absolute;
  left: 8px; bottom: 8px; z-index: 2;
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 6px 10px;
  cursor: pointer;
  background: rgba(0,0,0,.6);
  color: #fff; font-size: 12px; font-weight: 700;
  backdrop-filter: blur(2px);
}
.card .audio-play:hover { background: rgba(0,0,0,.75); }

/* Placeholder (DOC) già presente come .ph — ok */
